{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "title": "SmartWeb Driver Configuration",
    "definitions": {
      "mqtt": {
        "type": "object",
        "title": "MQTT",
        "headerTemplate": "{{self.channel}}",
        "properties": {
          "channel": {
            "type": "string",
            "title": "Device Id/Control Id",
            "minLength": 3,
            "propertyOrder": 1
          },
          "value_timeout_min": {
            "type": "integer",
            "title": "Value timeout (minutes)",
            "default": -1,
            "propertyOrder": 2
          }
        },
        "required": ["channel"]
      },
      "sensor": {
        "type": "object",
        "title": "SmartWeb sensor",
        "headerTemplate": "Sensor {{self.index}}",
        "properties": {
          "index": {
            "type": "integer",
            "title": "Index",
            "minimum": 0,
            "maximum": 255,
            "propertyOrder": 1
          }
        },
        "required": ["index"]
      },
      "output": {
        "type": "object",
        "title": "SmartWeb output mapping point",
        "headerTemplate": "Output mapping {{self.channel_id}}",
        "properties": {
          "channel_id": {
            "type": "integer",
            "title": "Index",
            "minimum": 0,
            "maximum": 31,
            "propertyOrder": 1
          }
        },
        "required": ["channel_id"]
      },
      "mapping": {
        "type": "object",
        "title": "Mapping",
        "headerTemplate": "Mapping of {{self.mqtt.device}}/{{self.mqtt.control}}",
        "properties": {
          "mqtt": {
            "propertyOrder": 1,
            "$ref": "#/definitions/mqtt",
            "options": {
              "disable_edit_json": true,
              "disable_collapse": true
          }
          },
          "sensor": {
            "propertyOrder": 2,
            "$ref": "#/definitions/sensor",
            "options": {
                "disable_edit_json": true,
                "disable_collapse": true,
                "disable_properties": true
            }
          },
          "output": {
            "propertyOrder": 3,
            "$ref": "#/definitions/output",
            "options": {
                "disable_edit_json": true,
                "disable_collapse": true,
                "disable_properties": true
            }
          }
        },
        "required": ["mqtt"],
        "_format": "grid"
      }
    },
    "properties": {
      "debug": {
        "type": "boolean",
        "title": "Enable debug logging",
        "default": false,
        "_format": "checkbox",
        "propertyOrder": 1
      },
      "poll_interval_ms": {
        "type": "integer",
        "title": "Polling interval of SmartWeb programs, ms",
        "default": 1000,
        "minimum": 1,
        "propertyOrder": 2
      },
      "controller_id": {
        "type": "integer",
        "title": "SmartWeb controller id",
        "default": 0,
        "minimum": 1,
        "maximum": 255,
        "propertyOrder": 3
      },
      "mappings": {
        "type": "array",
        "title": "Wirenboard to SmartWeb mappings",
        "items": { "$ref": "#/definitions/mapping" },
        "minItems": 1,
        "_format": "table",
        "propertyOrder": 4
      }
    },
    "required": ["controller_id", "mappings"],
    "defaultProperties" : ["poll_interval_ms", "controller_id", "mappings"],
    "options": {
      "disable_collapse": true
    },
    "configFile": {
      "path": "/etc/wb-mqtt-smartweb.conf",
      "service": "wb-mqtt-smartweb"
    }
  }
